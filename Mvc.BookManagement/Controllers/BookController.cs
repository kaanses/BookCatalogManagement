using AutoMapper;using Microsoft.AspNetCore.Mvc;using Microsoft.Extensions.Localization; using Mvc.BookManagement.Interfaces;using Ardalis.Result;using Mvc.BookManagement.Models.DTOs;using Mvc.BookManagement.Models.ViewModels;using Mvc.BookManagement.Resources.SharedResources; namespace Mvc.BookManagement.Controllers{    [Route("[controller]")]    public class BookController : Controller    {        private readonly IBookService _bookService;        private readonly IMapper _mapper;        private IResultHandler _resultHandler;        private readonly IStringLocalizer<SharedResource> _localizer;         public BookController(            IBookService bookService,             IMapper mapper,            IResultHandlerFactory resultHandlerFactory,            IStringLocalizer<SharedResource> localizer)         {            _bookService = bookService;            _mapper = mapper;            _localizer = localizer;             _resultHandler = resultHandlerFactory.Create(this);        }                [HttpGet]        [Route("Details/{id}")]        public async Task<IActionResult> Details(int id, CancellationToken cancellationToken = default)        {            var result = await _bookService.GetBookByIdAsync(id, cancellationToken);            return _resultHandler.HandleResult(result, book =>            {                var viewModel = _mapper.Map<BookViewModel>(book);                return Ok(viewModel);            });        }        [HttpPost]        [Route("Create")]        public async Task<IActionResult> Create([FromForm]BookCreateViewModel viewModel, CancellationToken cancellationToken = default)        {            var bookInputDto = _mapper.Map<BookInputDTO>(viewModel);            var result = await _bookService.CreateBookAsync(bookInputDto, cancellationToken);                        return _resultHandler.HandleResult(result, book =>            {                TempData["SuccessMessage"] = _localizer["BookCreatedSuccess"].Value;                return RedirectToAction("Index", "Home");            });        }                [HttpPost]        [Route("Edit")]        public async Task<IActionResult> Edit(int id, BookUpdateViewModel viewModel, CancellationToken cancellationToken = default)        {            var bookInputDto = _mapper.Map<BookInputDTO>(viewModel);            var result = await _bookService.UpdateBookAsync(id, bookInputDto, cancellationToken);                        return _resultHandler.HandleResult(result, book =>            {                TempData["SuccessMessage"] = _localizer["BookUpdatedSuccess"].Value;                return RedirectToAction("Index", "Home");            });        }                [HttpPost]        [Route("Delete")]        public async Task<IActionResult> Delete(int id, CancellationToken cancellationToken = default)        {            var result = await _bookService.DeleteBookAsync(id, cancellationToken);                        if (result.IsSuccess)            {                TempData["SuccessMessage"] = _localizer["BookDeletedSuccess"].Value;                return RedirectToAction("Index", "Home");            }                        if (result.Status == ResultStatus.NotFound)            {                return NotFound();            }                        TempData["ErrorMessage"] = _localizer["DeleteError"].Value;            return RedirectToAction("Index", "Home");        }    }}